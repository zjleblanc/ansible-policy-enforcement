# Quick Start Guide

This guide will help you set up and run the OPA (Open Policy Agent) server using Quadlet. **This setup is intended for testing and development purposes only.**

Inspect the [Quadlet template](../opa.container)

## ⚠️ Security Warning

This setup runs an OPA server with:
- No authentication (AuthN)
- No authorization (AuthZ)
- No TLS/HTTPS
- No access controls

**DO NOT use this configuration in production environments.** This setup is designed for local development and testing only.

## Prerequisites

- Podman installed on your system
- Make installed on your system
- Review the [Quadlet template](../opa.container)

## Running OPA Server with Quadlet

1. Run the OPA server using Podman:

```bash
make quadlet/run-opa-server
```

This command will:
- Create a policies directory (external to this repo) and copy policies to the destination
- Copy the quadlet template to the rootless quadlet directory
- Inject the appropriate directory for the policies volume
- Reload systemd to generate the unit file
- Stop/Start the opa service

## Verifying the Setup

1. Test the OPA server's health endpoint:
```bash
curl http://localhost:8181/health
```

You should receive a response indicating the server is healthy.

## Troubleshooting Notes

- Ensure systemd has reloaded to recognize the quadlet<br>
  `systemctl --user daemon-reload`
- Check the status of the systemd service<br>
  `systemctl --user status mysleep.service`
- Examine the service file generated by quadlet<br>
  `/usr/libexec/podman/quadlet -dryrun -user`
- Test the command your self based on the `ExecStart` property<br>
  _Note: you may have to fill in contextual values to run a test_

For more detailed information about OPA configuration and policy management, refer to the [official OPA documentation](https://www.openpolicyagent.org/docs/latest/). 